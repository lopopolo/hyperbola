# vim: set filetype=apache :

# NameVirtualHost *:80
<VirtualHost *:80>
  ServerName hyperbo.la
  DocumentRoot /var/www/hyperbola/
  <Directory />
    Options -Indexes FollowSymLinks
    AllowOverride none
    order allow,deny
    allow from all
  </Directory>
  WSGIScriptAlias / /var/www/hyperbola/conf/django.wsgi
  # redirect www to naked domain always
  RewriteEngine On
  RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
  RewriteRule ^(.*)$ http://%1$1 [R=301,L]

  XSendFile on
  XSendFilePath /var/www/hyperbola/media/
</VirtualHost>

<VirtualHost *:80>
  ServerName assets.hyperbo.la
  DocumentRoot /var/www/hyperbola/assets/
  <Directory />
    Options -Indexes FollowSymLinks
    AllowOverride none
    order allow,deny
    allow from all
  </Directory>
  <Directory /var/www/hyperbola/assets/>
    Options -Indexes FollowSymLinks
    AllowOverride none
    order allow,deny
    allow from all
  </Directory>
  ExpiresActive On
  ExpiresDefault "access plus 1 week"
</VirtualHost>

<VirtualHost *:80>
  ServerName media.hyperbo.la
  DocumentRoot /var/www/hyperbola/media/
  <Directory />
    Options -Indexes FollowSymLinks
    AllowOverride all
    order allow,deny
    allow from all
  </Directory>
  <Directory /var/www/hyperbola/media/>
    Options -Indexes FollowSymLinks
    AllowOverride all
    order allow,deny
    allow from all
  </Directory>
  ExpiresActive On
  ExpiresDefault "access plus 1 week"
</VirtualHost>

<VirtualHost *:80>
  ServerName wiki.hyperbo.la

  ProxyPass / http://0.0.0.0:4567/
  ProxyPassReverse / http://0.0.0.0:4567/

  <Location />
    AuthType Basic
    AuthName "hyperbola wiki"
    AuthUserFile /etc/apache2/wiki-auth
    Require valid-user
  </Location>
</VirtualHost>

