#!/bin/bash

shopt -s globstar nullglob

TEMP_DIR="$(mktemp -d)"
trap 'rm -rf $TEMP_DIR' EXIT
TEMP_PNG="$TEMP_DIR/out.png"

for png in "$1"/**/*.png
do
  pngcrush -brute "$png" "$TEMP_PNG"
  mv -f "$TEMP_PNG" "$png"
done
