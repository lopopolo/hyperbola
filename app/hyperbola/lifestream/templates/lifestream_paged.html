{% extends "lifestream_base.html" %}
{% load hyperbola_lifestream_tags imagekit %}

{% block title %}
{{ block.super }} {% if posts.number != 1 %} :: page {{ posts.number|escape }} {% endif %}
{% endblock title %}

{% block lifestream_content %}
{% for post in posts %}
<div class="panel panel-hyperbola">
  <div class="panel-heading lifestream-entry-header">
    <span class="date">
      <script>HyperbolaDateFormatter.write({{ post.pub_date|date:"U" }})</script>
      <noscript>
        {{ post.pub_date|date:"H:i T b d Y"|lower }}
      </noscript>
    </span>
    <a href="{{ post.get_absolute_url|escape }}">permalink</a>
  </div>
  <div class="panel-body">
    {% if post.lifestreampicture %}
    {% thumbnail "500x500"   post.lifestreampicture.picture crop=0 upscale=False as card %}
    {% thumbnail "1000x1000" post.lifestreampicture.picture crop=0 upscale=False as cardx2 %}
    {# access width and height before url: https://github.com/matthewwithanm/django-imagekit/issues/350 #}
    <div>
      <a href="{{ cardx2.url|escape }}">
        <img alt="Photo for post {{ post.id|escape }}" width="{{ card.width|escape }}" height="{{ card.height|escape }}" src="{{ card.url|escape }}" data-at2x="{{ cardx2.url|escape }}" class="center-block img-thumbnail img-thumbnail-hyperbola">
      </a>
    </div>
    {% endif %}
    <p class="lifestream-content">{{ post.blurb|urlize|hashtagize }}</p>
  </div>
</div>
{% endfor %}
<div>
  {% if links.newer %}
  <div class="pull-left"><a href="{{ links.newer|escape }}">&laquo; newer</a></div>
  {% endif %}
  {% if links.older %}
  <div class="pull-right"><a href="{{ links.older|escape }}">older &raquo;</a></div>
  {% endif %}
</div>
{% endblock lifestream_content %}
